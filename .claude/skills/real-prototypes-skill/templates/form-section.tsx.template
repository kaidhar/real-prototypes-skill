import React from "react";
import { useForm } from "react-hook-form";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Checkbox } from "@/components/ui/checkbox";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";

interface FormData {
  textField: string;
  emailField: string;
  selectField: string;
  textareaField: string;
  checkboxField: boolean;
}

interface FormSectionProps {
  title?: string;
  description?: string;
  onSubmit?: (data: FormData) => void;
  onCancel?: () => void;
  isLoading?: boolean;
  className?: string;
}

export function FormSection({
  title = "{/* FEATURE_TITLE */}",
  description,
  onSubmit,
  onCancel,
  isLoading = false,
  className = "",
}: FormSectionProps) {
  const {
    register,
    handleSubmit,
    setValue,
    watch,
    formState: { errors },
  } = useForm<FormData>({
    defaultValues: {
      textField: "",
      emailField: "",
      selectField: "",
      textareaField: "",
      checkboxField: false,
    },
  });

  const checkboxValue = watch("checkboxField");

  const handleFormSubmit = (data: FormData) => {
    onSubmit?.(data);
  };

  return (
    <div className={`bg-platform-background p-6 rounded-lg border border-platform-secondary/20 ${className}`}>
      {(title || description) && (
        <div className="mb-6">
          {title && (
            <h2 className="text-xl font-semibold text-platform-foreground">
              {title}
            </h2>
          )}
          {description && (
            <p className="mt-1 text-sm text-platform-foreground/60">
              {description}
            </p>
          )}
        </div>
      )}

      <form onSubmit={handleSubmit(handleFormSubmit)} className="space-y-6">
        {/* FEATURE_CONTENT */}

        {/* Text Input */}
        <div className="space-y-2">
          <Label
            htmlFor="textField"
            className="text-platform-foreground font-medium"
          >
            Text Field
            <span className="text-red-500 ml-1" aria-hidden="true">*</span>
          </Label>
          <Input
            id="textField"
            type="text"
            placeholder="Enter text..."
            className="bg-platform-background border-platform-secondary/30 text-platform-foreground placeholder:text-platform-foreground/40 focus:border-platform-primary focus:ring-platform-primary"
            aria-required="true"
            aria-invalid={!!errors.textField}
            aria-describedby={errors.textField ? "textField-error" : undefined}
            {...register("textField", { required: "This field is required" })}
          />
          {errors.textField && (
            <p id="textField-error" className="text-sm text-red-500" role="alert">
              {errors.textField.message}
            </p>
          )}
        </div>

        {/* Email Input */}
        <div className="space-y-2">
          <Label
            htmlFor="emailField"
            className="text-platform-foreground font-medium"
          >
            Email Field
          </Label>
          <Input
            id="emailField"
            type="email"
            placeholder="email@example.com"
            className="bg-platform-background border-platform-secondary/30 text-platform-foreground placeholder:text-platform-foreground/40 focus:border-platform-primary focus:ring-platform-primary"
            aria-invalid={!!errors.emailField}
            aria-describedby={errors.emailField ? "emailField-error" : undefined}
            {...register("emailField", {
              pattern: {
                value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,
                message: "Invalid email address",
              },
            })}
          />
          {errors.emailField && (
            <p id="emailField-error" className="text-sm text-red-500" role="alert">
              {errors.emailField.message}
            </p>
          )}
        </div>

        {/* Select Input */}
        <div className="space-y-2">
          <Label
            htmlFor="selectField"
            className="text-platform-foreground font-medium"
          >
            Select Field
          </Label>
          <Select
            onValueChange={(value) => setValue("selectField", value)}
          >
            <SelectTrigger
              id="selectField"
              className="bg-platform-background border-platform-secondary/30 text-platform-foreground focus:border-platform-primary focus:ring-platform-primary"
              aria-label="Select an option"
            >
              <SelectValue placeholder="Select an option..." />
            </SelectTrigger>
            <SelectContent className="bg-platform-background border-platform-secondary/30">
              <SelectItem
                value="option1"
                className="text-platform-foreground focus:bg-platform-secondary/10"
              >
                Option 1
              </SelectItem>
              <SelectItem
                value="option2"
                className="text-platform-foreground focus:bg-platform-secondary/10"
              >
                Option 2
              </SelectItem>
              <SelectItem
                value="option3"
                className="text-platform-foreground focus:bg-platform-secondary/10"
              >
                Option 3
              </SelectItem>
            </SelectContent>
          </Select>
        </div>

        {/* Textarea */}
        <div className="space-y-2">
          <Label
            htmlFor="textareaField"
            className="text-platform-foreground font-medium"
          >
            Description
          </Label>
          <Textarea
            id="textareaField"
            placeholder="Enter a description..."
            rows={4}
            className="bg-platform-background border-platform-secondary/30 text-platform-foreground placeholder:text-platform-foreground/40 focus:border-platform-primary focus:ring-platform-primary resize-none"
            {...register("textareaField")}
          />
        </div>

        {/* Checkbox */}
        <div className="flex items-start space-x-3">
          <Checkbox
            id="checkboxField"
            checked={checkboxValue}
            onCheckedChange={(checked) => setValue("checkboxField", !!checked)}
            className="border-platform-secondary/50 data-[state=checked]:bg-platform-primary data-[state=checked]:border-platform-primary mt-0.5"
          />
          <div className="space-y-1">
            <Label
              htmlFor="checkboxField"
              className="text-platform-foreground font-medium cursor-pointer"
            >
              I agree to the terms
            </Label>
            <p className="text-sm text-platform-foreground/60">
              By checking this box, you agree to our Terms of Service and Privacy Policy.
            </p>
          </div>
        </div>

        {/* Form Actions */}
        <div className="flex items-center justify-end gap-3 pt-4 border-t border-platform-secondary/10">
          {onCancel && (
            <Button
              type="button"
              variant="outline"
              onClick={onCancel}
              disabled={isLoading}
              className="border-platform-secondary text-platform-foreground hover:bg-platform-secondary/10"
            >
              Cancel
            </Button>
          )}
          <Button
            type="submit"
            disabled={isLoading}
            className="bg-platform-primary text-white hover:bg-platform-primary/90 disabled:opacity-50"
          >
            {isLoading ? "Submitting..." : "Submit"}
          </Button>
        </div>
      </form>
    </div>
  );
}

// Example usage:
// <FormSection
//   title="Contact Information"
//   description="Please fill out the form below"
//   onSubmit={(data) => console.log(data)}
//   onCancel={() => console.log("Cancelled")}
//   isLoading={false}
// />
